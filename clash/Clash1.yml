mixed-port: 7890
allow-lan: true
mode: Rule
log-level: info
external-controller: 0.0.0.0:9090
ipv6: true
find-process-mode: strict
global-client-fingerprint: chrome
profile:
  store-selected: true
  store-fake-ip: true
sniffer:
  enable: true
  sniff:
    HTTP:
      ports:
      - 80
      - 8080-8800
      override-destination: true
    TLS:
      ports:
      - 443
      - 8443
    QUIC:
      ports:
      - 443
      - 8443
tun:
  enable: true
  stack: mixed
  dns-hijack:
  - any:53
  auto-route: true
  auto-detect-interface: true
dns:
  enable: true
  listen: 0.0.0.0:53
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
  - '*.lan'
  - cable.auth.com
  - +.msftconnecttest.com
  - +.msftncsi.com
  - network-test.debian.org
  - detectportal.firefox.com
  - resolver1.opendns.com
  - +.srv.nintendo.net
  - +.stun.playstation.net
  - xbox.*.microsoft.com
  - +.xboxlive.com
  - stun.*
  - global.turn.twilio.com
  - global.stun.twilio.com
  - localhost.*.qq.com
  - +.logon.battlenet.com.cn
  - +.logon.battle.net
  - +.blzstatic.cn
  - +.cmpassport.com
  - id6.me
  - open.e.189.cn
  - mdn.open.wo.cn
  - opencloud.wostore.cn
  - auth.wosms.cn
  - +.jegotrip.com.cn
  - +.icitymobile.mobi
  - +.pingan.com.cn
  - +.cmbchina.com
  - +.cmbchina.com.cn
  - pool.ntp.org
  - +.pool.ntp.org
  - ntp.*.com
  - time.*.com
  - ntp?.*.com
  - time?.*.com
  - time.*.gov
  - time.*.edu.cn
  - +.ntp.org.cn
  - time.*.apple.com
  default-nameserver:
  - 223.5.5.5
  nameserver:
  - https://doh.pub/dns-query
  - https://dns.alidns.com/dns-query
  proxy-server-nameserver:
  - https://doh.pub/dns-query
proxies:
- alterId: 0
  cipher: auto
  client-fingerprint: chrome
  name: åŠ æ‹¿å¤§ 001
  network: ws
  port: 2086
  server: 104.21.4.14
  skip-cert-verify: false
  tfo: false
  tls: false
  type: vmess
  udp: true
  uuid: 7d93e992-48cf-42d4-84f8-75768e815a4c
  ws-opts:
    headers:
      Host: admin.arzonhost.ir
    path: /
- alterId: 0
  cipher: auto
  country: ğŸ‡¨ğŸ‡¦CA
  delay: 2438
  h2-opts: {}
  http-opts: {}
  name: åŠ æ‹¿å¤§ 002
  network: ws
  port: 443
  server: 158.51.121.36
  servername: 158.51.121.36
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: 03fcc618-b93d-6796-6aed-8a38c975d581
  ws-opts:
    headers:
      HOST: 158.51.121.36
    path: /linkvws
- alterId: 0
  cipher: auto
  country: ğŸ‡ºğŸ‡¸US
  delay: 1113
  h2-opts: {}
  http-opts: {}
  name: ç¾å›½ 001
  network: ws
  port: 80
  server: 172.64.104.182
  servername: fr.grpc.gay
  skip-cert-verify: true
  type: vmess
  uuid: f0f067fe-8e6d-4d95-816b-601038fd5876
  ws-opts:
    headers:
      HOST: fr.grpc.gay
    path: /rongseven?ed=2048
- alterId: 0
  cipher: auto
  country: ğŸ‡ºğŸ‡¸US
  delay: 1269
  h2-opts: {}
  http-opts: {}
  name: ç¾å›½ 002
  network: ws
  port: 443
  server: 23.154.136.2
  servername: 23.154.136.2
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: 03fcc618-b93d-6796-6aed-8a38c975d581
  ws-opts:
    headers:
      HOST: 23.154.136.2
    path: /linkvws
- alterId: 0
  cipher: auto
  country: ğŸZZ
  delay: 2419
  h2-opts: {}
  http-opts: {}
  name: åŠ æ‹¿å¤§ 003
  network: ws
  port: 80
  server: www.speedtest.net
  servername: us4e-20240111.v2freevpn.com
  skip-cert-verify: true
  type: vmess
  uuid: 2a8a10fb-9ca3-367e-a234-cf09f841be4f
  ws-opts:
    headers:
      HOST: us4e-20240111.v2freevpn.com
    path: /v149-dskds65
- alterId: 0
  cipher: auto
  country: ğŸZZ
  delay: 1235
  h2-opts: {}
  http-opts: {}
  name: åŠ æ‹¿å¤§ 004
  network: ws
  port: 443
  server: 104.21.25.68
  servername: uk1-vmess.sshmax.xyz
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: a6caa850-8043-403a-bbcf-589cea2c1656
  ws-opts:
    headers:
      HOST: uk1-vmess.sshmax.xyz
    path: /vmess
- alterId: 0
  cipher: auto
  country: US
  h2-opts: {}
  http-opts: {}
  name: ç¾å›½ 003
  network: ws
  port: 443
  server: 172.67.183.55
  servername: de3-vmess.sshmax.xyz
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: 7142b543-45a8-4274-b80d-f401e7892f5c
  ws-opts:
    headers:
      HOST: de3-vmess.sshmax.xyz
    path: /vmess
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 005
  network: ws
  port: 2052
  server: 104.18.25.92
  tls: false
  type: vmess
  uuid: f584de15-2034-4170-a723-f48c2bae5e0f
  ws-opts:
    headers:
      Host: mysan2.jaquay22.workers.dev
    path: /afrhms16v.bestxray.buzz/linkws
- alterId: 0
  cipher: auto
  country: ğŸZZ
  delay: 1256
  h2-opts: {}
  http-opts: {}
  name: åŠ æ‹¿å¤§ 006
  network: ws
  port: 443
  server: 104.21.31.87
  servername: ch1-vmess.sshmax.xyz
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: e3872a5b-ee93-4a42-b85b-a785c31e5b80
  ws-opts:
    headers:
      HOST: ch1-vmess.sshmax.xyz
    path: /vmess
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 007
  network: ws
  port: 8080
  server: 104.20.26.40
  servername: fantastic-doe-bids-ended.trycloudflare.com
  skip-cert-verify: true
  tls: false
  type: vmess
  uuid: 82cb93a3-65a9-4dac-a2a7-d997b6c26d6a
  ws-opts:
    headers:
      host: fantastic-doe-bids-ended.trycloudflare.com
    path: 82cb93a3-65a9-4dac-a2a7-d997b6c26d6a-vm
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 008
  network: ws
  port: 8080
  server: 172.67.199.185
  skip-cert-verify: true
  type: vmess
  uuid: b551aa22-22af-11ee-b8d8-f23c932eb68d
  ws-opts:
    headers:
      Host: oiictw.yydsii.com
    path: /
- alterId: 0
  cipher: auto
  country: ğŸ‡ºğŸ‡¸US
  delay: 2194
  h2-opts: {}
  http-opts: {}
  name: ç¾å›½ 004
  network: ws
  port: 8080
  server: 172.67.172.50
  servername: oiictw.yydsii.com
  skip-cert-verify: true
  type: vmess
  uuid: b551aa22-22af-11ee-b8d8-f23c932eb68d
  ws-opts:
    headers:
      HOST: oiictw.yydsii.com
    path: /
- alterId: 0
  cipher: auto
  country: ğŸ‡ºğŸ‡¸US
  delay: 2445
  h2-opts: {}
  http-opts: {}
  name: åŠ æ‹¿å¤§ 009
  network: ws
  port: 8080
  server: 172.67.185.218
  servername: oiictw.yydsii.com
  skip-cert-verify: true
  type: vmess
  uuid: b551aa22-22af-11ee-b8d8-f23c932eb68d
  ws-opts:
    headers:
      HOST: oiictw.yydsii.com
    path: /
- alterId: 0
  cipher: auto
  country: ğŸZZ
  delay: 1417
  h2-opts: {}
  http-opts: {}
  name: åŠ æ‹¿å¤§ 010
  network: ws
  port: 80
  server: 104.21.75.79
  servername: ee2-vmess.sshmax.xyz
  skip-cert-verify: true
  type: vmess
  uuid: 5c6f16ce-6a20-41e5-9274-06b4c45051b5
  ws-opts:
    headers:
      HOST: ee2-vmess.sshmax.xyz
    path: /vmess
- country: ğŸ‡¬ğŸ‡§GB
  delay: 844
  name: ç¾å›½ 005
  network: tcp
  password: telegram-id-privatevpns
  port: 22222
  server: 18.171.213.165
  sni: trojan.burgerip.co.uk
  type: trojan
  udp: true
- country: ğŸ‡ºğŸ‡¸US
  delay: 1266
  fingerprint: chrome
  name: åŠ æ‹¿å¤§ 011
  network: ws
  password: 7f2782e1-1f1a-4c5b-b4ae-cead54b8c381
  port: 443
  server: 172.67.191.234
  sni: nl1.tRojANVpN.xYZ
  type: trojan
  udp: true
  ws-opts:
    headers:
      Host: nl1.tRojANVpN.xYZ
    path: /
- alterId: 0
  cipher: auto
  name: ç¾å›½ 006
  network: ws
  port: 8080
  server: 162.159.137.249
  skip-cert-verify: true
  tls: false
  type: vmess
  uuid: 028c8131-9e3e-4836-94ac-ea7f24d4d05a
  ws-opts:
    headers:
      host: nest-emily-healing-h.trycloudflare.com
    path: 028c8131-9e3e-4836-94ac-ea7f24d4d05a-vm
- name: æ³•å›½ 001
  network: tcp
  password: e68ecafd-6565-44e3-9de2-a37eb3234b62
  port: 30502
  server: fr01.freeflyingcloud.xyz
  skip-cert-verify: true
  sni: fr01.freeflyingcloud.xyz
  type: trojan
  udp: true
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 012
  network: ws
  port: 2052
  server: 104.18.177.19
  servername: cache-5.cn-db.top
  skip-cert-verify: true
  tls: false
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100.100.17.177.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: ç¾å›½ 007
  network: ws
  port: 2095
  server: 104.18.55.145
  servername: data-5.cn-db.top
  skip-cert-verify: true
  tls: false
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100.100.17.55.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 013
  network: ws
  port: 80
  server: 104.19.165.93
  servername: cache-5.cn-db.top
  skip-cert-verify: true
  tls: false
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100.100.17.165.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 014
  network: ws
  port: 443
  server: 104.19.84.89
  servername: cache-5.cn-db.top
  skip-cert-verify: true
  tls: true
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100-100-17-84.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 015
  network: ws
  port: 2052
  server: 104.17.12.16
  servername: data-5.cn-db.top
  skip-cert-verify: true
  tls: false
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100.100.17.12.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 016
  network: ws
  port: 80
  server: 104.18.86.10
  servername: cache-5.cn-db.top
  skip-cert-verify: true
  tls: false
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100.100.17.86.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 017
  network: ws
  port: 2095
  server: 104.18.81.185
  servername: cache-4.cn-db.top
  skip-cert-verify: true
  tls: false
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100.100.17.81.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 018
  network: ws
  port: 2095
  server: 104.18.230.231
  servername: data-4.cn-db.top
  skip-cert-verify: true
  tls: false
  type: vmess
  udp: true
  uuid: 4f574408-dfef-338a-a7d9-f7d1e70ff8d9
  ws-opts:
    headers:
      Host: 100.100.17.230.cn-db.top
    path: /db00
- alterId: 0
  cipher: auto
  name: èŠ¬å…° 001
  network: tcp
  port: 5855
  server: 65.109.199.41
  servername: ''
  tls: false
  type: vmess
  uuid: af99c3d4-3dba-4aa4-8946-cd3fe1bb0de0
- alterId: 0
  cipher: auto
  name: èŠ¬å…° 002
  network: tcp
  port: 3627
  server: 65.109.199.41
  servername: ''
  tls: false
  type: vmess
  uuid: 14ad6583-3a7c-4e73-efac-a38abca7f452
- alterId: 0
  cipher: auto
  name: èŠ¬å…° 003
  network: tcp
  port: 5614
  server: 65.109.199.41
  servername: ''
  tls: false
  type: vmess
  uuid: b9c45c6f-5387-4ad5-91bd-295d5bdf5a35
- alterId: 0
  cipher: auto
  name: èŠ¬å…° 004
  network: tcp
  port: 4944
  server: 65.109.199.41
  servername: ''
  tls: false
  type: vmess
  uuid: 384e6bb8-f7f1-4633-929f-8133dbae9e06
- alterId: 0
  cipher: auto
  name: èŠ¬å…° 005
  network: tcp
  port: 5805
  server: 65.109.199.41
  servername: ''
  tls: false
  type: vmess
  uuid: 2fd02886-8bec-4fb6-db12-70a6b924f740
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 019
  network: ws
  port: 8880
  server: 162.159.152.153
  skip-cert-verify: true
  type: vmess
  uuid: 67c5ce45-7b48-473e-bf25-e4c830b0ed24
  ws-opts:
    headers:
      Host: csjp.iiio.wiki
    path: /aries?ed=2048
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 020
  network: ws
  port: 2087
  server: 104.21.7.162
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: 520a5f45-d354-42f4-a658-18dbc3754645
  ws-opts:
    headers:
      Host: backend.app-browser.org
    path: /fws
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 021
  network: ws
  port: 2052
  server: onea.flha.ru
  skip-cert-verify: true
  type: vmess
  uuid: 89d8ef31-ade9-4aca-8fbc-1edbba6cda16
  ws-opts:
    headers:
      Host: onea.flha.ru
    path: /
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 022
  network: ws
  port: 2052
  server: 104.21.33.130
  skip-cert-verify: true
  type: vmess
  uuid: 544f2e93-51b0-4d47-fd72-e7d858021bbd
  ws-opts:
    headers:
      Host: family.mgtajhiz.ir
    path: /
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 023
  network: ws
  port: 443
  server: 56c5d2b1-575f-4718-ad37-4cb1fb0d44dc.asoul-ava.top
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: 5f726fe3-d82e-4da5-a711-8af0cbb2b682
  ws-opts:
    headers:
      Host: 56c5d2b1-575f-4718-ad37-4cb1fb0d44dc.asoul-ava.top
    path: /azumase.ren
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 024
  network: ws
  port: 443
  server: 1a2d514b-37cf-499f-8d08-d017a92ab5bb.asoul-ava.top
  skip-cert-verify: true
  tls: true
  type: vmess
  uuid: 5f726fe3-d82e-4da5-a711-8af0cbb2b682
  ws-opts:
    headers:
      Host: 1a2d514b-37cf-499f-8d08-d017a92ab5bb.asoul-ava.top
    path: /azumase.ren
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 025
  network: ws
  port: 80
  server: 104.20.72.75
  skip-cert-verify: true
  type: vmess
  uuid: 852ba4ac-49bc-4c7e-b757-6d456a615546
  ws-opts:
    headers:
      Host: é¢æ¡thehauntedhotelé‡é¤æå‡»ä¿±ä¹éƒ¨.suonycars.buzz.
    path: /t.me-DarkVPNpro-t.me-DarkVPNpro-t.me-DarkVPNpro
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 026
  network: ws
  port: 2052
  server: 172.67.76.35
  skip-cert-verify: true
  type: vmess
  uuid: e7bd848c-c1c9-40a4-b1d9-eba048a340c5
  ws-opts:
    headers:
      Host: wtywwcrzjp5.yofnhkfc.xyz
    path: /video/9TfVEyku
- alterId: 0
  cipher: auto
  name: åŠ æ‹¿å¤§ 027
  network: ws
  port: 80
  server: 118ejob.ir
  skip-cert-verify: true
  type: vmess
  uuid: 47d0805b-6b81-49f1-9813-776032d2c076
  ws-opts:
    headers:
      Host: at1-vmess.sshmax.xyz
    path: /vmess
proxy-groups:
- name: PROXY
  type: select
  proxies:
  - LOAD-BALANCE
  - SELECT
  - FALLBACK
  - DIRECT
- name: SELECT
  type: select
  proxies: &id001
  - åŠ æ‹¿å¤§ 001
  - åŠ æ‹¿å¤§ 002
  - ç¾å›½ 001
  - ç¾å›½ 002
  - åŠ æ‹¿å¤§ 003
  - åŠ æ‹¿å¤§ 004
  - ç¾å›½ 003
  - åŠ æ‹¿å¤§ 005
  - åŠ æ‹¿å¤§ 006
  - åŠ æ‹¿å¤§ 007
  - åŠ æ‹¿å¤§ 008
  - ç¾å›½ 004
  - åŠ æ‹¿å¤§ 009
  - åŠ æ‹¿å¤§ 010
  - ç¾å›½ 005
  - åŠ æ‹¿å¤§ 011
  - ç¾å›½ 006
  - æ³•å›½ 001
  - åŠ æ‹¿å¤§ 012
  - ç¾å›½ 007
  - åŠ æ‹¿å¤§ 013
  - åŠ æ‹¿å¤§ 014
  - åŠ æ‹¿å¤§ 015
  - åŠ æ‹¿å¤§ 016
  - åŠ æ‹¿å¤§ 017
  - åŠ æ‹¿å¤§ 018
  - èŠ¬å…° 001
  - èŠ¬å…° 002
  - èŠ¬å…° 003
  - èŠ¬å…° 004
  - èŠ¬å…° 005
  - åŠ æ‹¿å¤§ 019
  - åŠ æ‹¿å¤§ 020
  - åŠ æ‹¿å¤§ 021
  - åŠ æ‹¿å¤§ 022
  - åŠ æ‹¿å¤§ 023
  - åŠ æ‹¿å¤§ 024
  - åŠ æ‹¿å¤§ 025
  - åŠ æ‹¿å¤§ 026
  - åŠ æ‹¿å¤§ 027
- name: LOAD-BALANCE
  type: load-balance
  url: http://www.gstatic.com/generate_204
  interval: 3600
  strategy: consistent-hashing
  proxies: *id001
- name: FALLBACK
  type: fallback
  url: http://www.gstatic.com/generate_204
  interval: 3600
  proxies: *id001
- name: GITHUB
  type: select
  proxies: &id002
  - PROXY
  - LOAD-BALANCE
  - SELECT
  - FALLBACK
  - DIRECT
- name: OPENAI
  type: select
  proxies: *id002
- name: BLOCK
  type: select
  proxies:
  - REJECT
  - DIRECT
- name: FINAL
  type: select
  proxies:
  - PROXY
  - DIRECT
rules:
  - RULE-SET,proxy-classical,PROXY
  - RULE-SET,direct-classical,DIRECT
  - RULE-SET,block,BLOCK
  - RULE-SET,applications,DIRECT
  - RULE-SET,icloud,DIRECT
  - RULE-SET,apple,DIRECT
  - RULE-SET,github,GITHUB
  - RULE-SET,openai,OPENAI
  - RULE-SET,google,PROXY
  - RULE-SET,youtube,PROXY
  - RULE-SET,telegram,PROXY
  - RULE-SET,spotify,PROXY
  - RULE-SET,gfw,PROXY
  - GEOIP,LAN,DIRECT,no-resolve
  - GEOIP,CN,DIRECT
  - MATCH,FINAL

rule-providers:
  icloud:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/icloud.yaml"
    path: ./rules/classical/icloud.yaml
    interval: 86400

  apple:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/apple.yaml"
    path: ./rules/classical/apple.yaml
    interval: 86400

  gfw:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/domain/gfw.yaml"
    path: ./rules/domain/gfw.yaml
    interval: 86400

  youtube:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/youtube.yaml"
    path: ./rules/classical/youtube.yaml
    interval: 86400
    
  google:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/google.yaml"
    path: ./rules/classical/google.yaml
    interval: 86400

  github:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/github.yaml"
    path: ./rules/classical/github.yaml
    interval: 86400

  openai:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/openai.yaml"
    path: ./rules/classical/openai.yaml
    interval: 86400

  telegram:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/telegram.yaml"
    path: ./rules/classical/telegram.yaml
    interval: 86400

  spotify:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/spotify.yaml"
    path: ./rules/classical/spotify.yaml
    interval: 86400

  applications:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/applications.yaml"
    path: ./rules/classical/applications.yaml
    interval: 86400
    
  block:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/block.yaml"
    path: ./rules/classical/block.yaml
    interval: 86400

  direct-classical:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/direct.yaml"
    path: ./rules/classical/direct.yaml
    interval: 86400
  proxy-classical:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/anaer/Sub@main/rules/classical/proxy.yaml"
    path: ./rules/classical/proxy.yaml
    interval: 86400

script:
  code: >
    def main(ctx, metadata):
      # è§„åˆ™åˆ—è¡¨å®šä¹‰(è§„åˆ™å:ä»£ç†è§„åˆ™), ä¾¿äºè°ƒæ•´å¤„ç†é¡ºåº, æš‚æ—¶æŒ‰ç…§è§„åˆ™æ•°é‡è¿›è¡Œå¤„ç†
      ruleList = {
        "proxy-classical":"PROXY",
        "direct-classical":"DIRECT",

        "github":"DIRECT",
        "spotify":"DIRECT",

        "telegram":"PROXY",
        "google":"PROXY",
        "gfw":"PROXY",

        "advertising":"REJECT"
      }

      port = int(metadata['dst_port'])

      if metadata['network'] == 'UDP' and port == 443:
          ctx.log('[Script] matched QUIC traffic use reject')
          return 'REJECT'

      # è§£æhost->ipèµ‹å€¼åˆ°metadataä¸­ ç”¨äºåç»­åˆ¤æ–­
      ip = metadata['dst_ip']
      if ip == "":
        ip = ctx.resolve_ip(metadata["host"])
        metadata["dst_ip"] = ip

      if ip == "":
        return "DIRECT"

      # éå†è§„åˆ™ç­–ç•¥, æœ‰å‘½ä¸­å³è¿”å›
      for rule,policy in ruleList.items():
        if ctx.rule_providers[rule].match(metadata):
          ctx.log("[match] {host} matched rule [{rule}] use {policy}".format(host=metadata["host"],rule=rule,policy=policy))
          return policy

      # åˆ¤æ–­ipæ˜¯å¦å±€åŸŸç½‘ä»¥åŠä¸­å›½, æ˜¯åˆ™ç›´è¿ PS: å…œåº•èµ°ç›´è¿çš„è¯ è¿™æ®µé€»è¾‘å¯ä»¥æ³¨é‡Š
      # code = ctx.geoip(ip)
      # ctx.log('[geoip] {host} {ip} {code}'.format(host=metadata["host"],ip=ip,code=code))
      # if code == "LAN" or code == "CN":
      #   return "DIRECT"

      # æ¼ç½‘ä¹‹é±¼èµ°ç›´è¿
      return "DIRECT"
